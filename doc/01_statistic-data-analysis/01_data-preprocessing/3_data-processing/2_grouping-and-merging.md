# グループ化とマージ
# もくじ
- [グループ化とマージ](#グループ化とマージ)
- [もくじ](#もくじ)
- [1. グループ化](#1-グループ化)
- [2. ビニング](#2-ビニング)
- [99. 参考](#99-参考)

# 1. グループ化

列のグループ化を考えます。

- グループ化の例
    - グループ化して変数に入れると変数にはGroupbyオブジェクトが入ります。

```python
df.groupby('items').get_group('item_1')
g1 = df.groupby('items')
print(g1.groups)
df.groupby('items').size()
# まとめて集約
df.groupby("袋詰場所").agg(np.sum)
# 辞書を使った集約
df.groupby("袋詰場所").agg({"総生産数":np.sum, "ロット":"first" })
```

# 2. ビニング

非連続値を**ビン（＝bin（棚））**というものを使ってより少ない数で分割してグループ分けする手法です。ビン分割とも言います。

例：人の年齢が入っている列があるとし、それを[10代、20代、30代・・・]といった年代ごとに区間でグループ分けするように使うなど。

作成した**棚**に元データ（今回は年齢データ）を仕分けるイメージです。

当然ですが、ビンの数はソースとなるデータより少なくなります。

```python
# 年齢データ。
ages = [random.randint(0, 100) for i in range(20)]
print(ages)
#[84, 73, 27, 85, 8, 17, 46, 16, 95, 62, 38, 47, 63, 44, 69, 26, 0, 40, 34, 79]

#この年齢データをグループ分けするためのBinsを用意する
bins = np.arange(0,90,10) #連番を生成
print(bin)
# >>> [ 0 10 20 30 40 50 60 70 80]

#カットする
cats = pd.cut(ages, bins)
print(cats)

# [NaN, (70.0, 80.0], (20.0, 30.0], NaN, (0.0, 10.0], ..., (20.0, 30.0], NaN, (30.0, 40.0], (30.0, 40.0], (70.0, 80.0]]
# Length: 20
# Categories (8, interval[int64]): [(0, 10] < (10, 20] < (20, 30] < (30, 40] < (40, 50] < (50, 60] < (60, 70] < (70, 80]]
```

# 99. 参考

- [Python Pandas データ前処理 個人メモ - Qiita](https://qiita.com/jooji/items/89fc03018e31f3e89519)